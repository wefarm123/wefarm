<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WEFARM Tech Tools</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

  <!-- Header / Hero -->
  <section class="py-5 bg-success text-white text-center">
    <div class="container">
      <h1 class="display-4">WEFARM Tech Tools</h1>
      <p class="lead">AI se empowered smart farming tools for our Kisans üåæ</p>
    </div>
  </section>

  <!-- Crop Planner Tool -->
<section class="py-5" id="crop-planner">
  <div class="container">
    <h2 class="text-center mb-4">üå± AI Crop Planning Tool</h2>
    <p class="text-center mb-5">Kisaan bhaiyo! Yeh tool aapke farm ke liye best crop plan suggest karega based on season, soil aur mandi rates.</p>

    <form id="cropPlannerForm" class="row g-3 justify-content-center">
      <div class="col-md-3">
        <label class="form-label">Location</label>
        <input type="text" class="form-control" id="location" placeholder="e.g., Patna, Bihar" required>
      </div>
      <div class="col-md-3">
        <label class="form-label">Season</label>
        <select class="form-select" id="season" required>
          <option value="">Choose...</option>
          <option>Rabi</option>
          <option>Kharif</option>
          <option>Zaid</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">Soil Type</label>
        <select class="form-select" id="soil" required>
          <option value="">Choose...</option>
          <option>Alluvial</option>
          <option>Black</option>
          <option>Red</option>
          <option>Laterite</option>
          <option>Sandy</option>
          <option>Clay</option>
        </select>
      </div>
      <div class="col-md-12 text-center">
        <button type="submit" class="btn btn-success btn-lg">üöÄ Suggest Crops</button>
      </div>
    </form>

    <div id="cropResults" class="mt-5 text-center" style="display:none;">
      <h4>üåæ Suggested Crops:</h4>
      <p id="suggestionText" class="lead mt-3"></p>
    </div>
  </div>
</section>

<script>
  const cropSuggestions = {
    "Rabi": {
      "Alluvial": ["Wheat", "Mustard", "Barley"],
      "Black": ["Chickpea", "Lentil", "Wheat"],
      "Red": ["Wheat", "Mustard"],
      "Laterite": ["Pea", "Mustard"],
      "Sandy": ["Carrot", "Onion"],
      "Clay": ["Wheat", "Barley"]
    },
    "Kharif": {
      "Alluvial": ["Paddy", "Maize", "Cotton"],
      "Black": ["Soybean", "Pigeon Pea", "Cotton"],
      "Red": ["Millets", "Groundnut"],
      "Laterite": ["Paddy", "Sesame"],
      "Sandy": ["Moong", "Bajra"],
      "Clay": ["Paddy", "Maize"]
    },
    "Zaid": {
      "Alluvial": ["Watermelon", "Cucumber"],
      "Black": ["Sunflower", "Moong"],
      "Red": ["Melon", "Pumpkin"],
      "Laterite": ["Cucumber", "Gourd"],
      "Sandy": ["Watermelon", "Muskmelon"],
      "Clay": ["Cucumber", "Bitter Gourd"]
    }
  };

  document.getElementById("cropPlannerForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const season = document.getElementById("season").value;
    const soil = document.getElementById("soil").value;
    const crops = cropSuggestions[season]?.[soil] || ["Data unavailable. Try different inputs."];

    document.getElementById("suggestionText").innerText = crops.join(", ");
    document.getElementById("cropResults").style.display = "block";
  });
</script>

<!-- Crop Doctor Tool -->
<section class="py-5 bg-light" id="crop-doctor">
  <div class="container text-center">
    <h2>üßë‚Äç‚öïÔ∏è AI Crop Doctor</h2>
    <p class="mb-4">Apne faslon ka health check-up karein! Yeh AI tool symptoms ke basis par disease identify karega aur treatment suggest karega.</p>

    <form id="cropDoctorForm" class="row g-3 justify-content-center">
      <div class="col-md-4">
        <label class="form-label">Vegetable</label>
        <select class="form-select" id="vegetable" required>
          <option value="">Choose...</option>
          <option>Tomato</option>
          <option>Potato</option>
          <option>Onion</option>
          <option>Chili</option>
          <option>Cabbage</option>
          <option>Cauliflower</option>
          <option>Brinjal</option>
          <option>Lady Finger</option>
          <option>Spinach</option>
          <option>Carrot</option>
          <option>Cucumber</option>
          <option>Pumpkin</option>
          <option>Bitter Gourd</option>
          <option>Bottle Gourd</option>
          <option>Peas</option>
          <option>Beans</option>
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Symptom</label>
        <select class="form-select" id="symptom" required>
          <option value="">Choose...</option>
          <option>Yellowing Leaves</option>
          <option>Leaf Spots</option>
          <option>Wilting</option>
          <option>Fruits Rotting</option>
          <option>White Powder on Leaves</option>
          <option>Stunted Growth</option>
          <option>Holes in Leaves</option>
        </select>
      </div>
      <div class="col-md-12 text-center">
        <button type="submit" class="btn btn-success btn-lg">ü©∫ Diagnose</button>
      </div>
    </form>

    <div id="diagnosisResult" class="mt-5 text-center" style="display:none;">
      <h4>üß™ Diagnosis Result:</h4>
      <p id="diseaseOutput" class="lead mt-3"></p>
    </div>
  </div>
</section>

<script>
  const cropDiseases = {
    "Tomato": {
      "Yellowing Leaves": "Possible cause: Nutrient Deficiency or Fusarium Wilt. Treatment: Apply balanced fertilizer, avoid waterlogging.",
      "Leaf Spots": "Possible cause: Early Blight. Treatment: Use Mancozeb-based fungicide.",
      "White Powder on Leaves": "Powdery Mildew. Treatment: Use sulfur-based fungicide."
    },
    "Potato": {
      "Wilting": "Bacterial Wilt. Treatment: Remove affected plants, improve drainage.",
      "Leaf Spots": "Late Blight. Treatment: Spray with Metalaxyl fungicide."
    },
    "Onion": {
      "Yellowing Leaves": "Downy Mildew. Treatment: Spray fungicide and avoid overcrowding.",
      "Stunted Growth": "Mite Infestation. Treatment: Use recommended acaricide."
    },
    "Cabbage": {
      "Holes in Leaves": "Cabbage Worms. Treatment: Use neem oil or Bt pesticide."
    },
    "Cauliflower": {
      "Yellowing Leaves": "Boron deficiency. Treatment: Spray borax solution."
    },
    "Brinjal": {
      "Leaf Spots": "Bacterial Leaf Spot. Treatment: Copper-based fungicide.",
      "Wilting": "Root-knot Nematode. Treatment: Use neem cake in soil."
    },
    "Lady Finger": {
      "White Powder on Leaves": "Powdery Mildew. Treatment: Use sulfur-based fungicide."
    },
    "Chili": {
      "Fruits Rotting": "Anthracnose. Treatment: Spray fungicide before fruiting."
    },
    "Spinach": {
      "Yellowing Leaves": "Downy Mildew. Treatment: Avoid overhead watering."
    },
    "Carrot": {
      "Stunted Growth": "Nematodes. Treatment: Solarize the soil before sowing."
    },
    "Cucumber": {
      "White Powder on Leaves": "Powdery Mildew. Treatment: Spray potassium bicarbonate."
    },
    "Pumpkin": {
      "Leaf Spots": "Angular Leaf Spot. Treatment: Use copper oxychloride spray."
    },
    "Bitter Gourd": {
      "Fruits Rotting": "Fruit Fly. Treatment: Use pheromone traps."
    },
    "Bottle Gourd": {
      "Yellowing Leaves": "Nutrient deficiency or fungal rot. Treat accordingly."
    },
    "Peas": {
      "Wilting": "Fusarium Wilt. Treatment: Crop rotation and clean seeds."
    },
    "Beans": {
      "Leaf Spots": "Rust. Treatment: Mancozeb spray every 10 days."
    }
  };

  document.getElementById("cropDoctorForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const vegetable = document.getElementById("vegetable").value;
    const symptom = document.getElementById("symptom").value;
    const diagnosis = cropDiseases[vegetable]?.[symptom] || "‚ö†Ô∏è Sorry, koi data nahi mila. Try different combination.";

    document.getElementById("diseaseOutput").innerText = diagnosis;
    document.getElementById("diagnosisResult").style.display = "block";
  });
</script>

<!-- Image-Based AI Diagnosis -->
  <section class="py-5" id="ai-diagnosis">
    <div class="container">
      <div class="card p-4 shadow">
        <h4 class="text-center mb-3">üì∏ Diagnose with Image (AI)</h4>
        <input type="file" id="imageUpload" class="form-control mb-3" accept="image/*">

<div class="text-center mt-3">
<button id="aiDiagnoseBtn" class="btn btn-success mt-3" style="width: 200px;">
  üåø AI Se Jaane, Bimari Pehchaane!
</button>
        <div id="result" class="text-center mt-3 fs-5 fw-bold text-success"></div>
        <div id="diagnosisResultAI" class="mt-4 text-dark w-100 text-center"></div>
        <img id="previewImage" class="mt-3 img-fluid mx-auto d-block" style="max-height: 300px; display: none;" />
      </div>
    </div>
  </section>

  <!-- TensorFlow.js & Teachable Machine -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest"></script>
  <script>
    const modelURL = "model";
    let model, maxPredictions;

    async function loadModel() {
      const tmImage = window.tmImage;
      model = await tmImage.load(modelURL + "model.json", modelURL + "metadata.json");
      maxPredictions = model.getTotalClasses();
    }

    async function classifyImage() {
      const fileInput = document.getElementById("imageUpload");
      const resultDiv = document.getElementById("diagnosisResultAI");
      const preview = document.getElementById("previewImage");

      if (!fileInput.files.length) {
        alert("Please upload an image first!");
        return;
      }

      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onload = async function () {
        const img = new Image();
        img.src = reader.result;
        img.onload = async function () {
          preview.src = reader.result;
          preview.style.display = "block";

          await loadModel();
          const prediction = await model.predict(img);
          prediction.sort((a, b) => b.probability - a.probability);

          const predictedClass = prediction[0].className;
          const treatment = getTreatment(predictedClass);
          resultDiv.innerHTML = `<strong>ü¶† Disease:</strong> ${predictedClass.replace(/___/g, " ‚Üí ")}<br><strong>üíä Treatment:</strong> ${treatment}`;
        };
      };
      reader.readAsDataURL(file);
    }

    function getTreatment(disease) {
      const treatments = {
        "Tomato___Early_blight": "Spray Mancozeb 2g/L weekly for 2 weeks.",
        "Tomato___Late_blight": "Use Copper Oxychloride or Ridomil Gold.",
        "Potato___Late_blight": "Spray with Metalaxyl-based fungicides.",
        "Bell_Pepper___Bacterial_spot": "Apply copper-based bactericides.",
        "Chili___Anthracnose": "Use carbendazim or azoxystrobin.",
        "Brinjal___Shoot_and_fruit_borer": "Spray neem oil or Spinosad."
      };
      return treatments[disease] || "Consult local agri expert.";
    }
<script>
  let model;

  
  async function loadModel() {
    model = await tf.loadLayersModel('model/model.json');
    console.log("‚úÖ AI Model Loaded Successfully");
  }

  
  async function classifyImage() {
    const fileInput = document.querySelector('input[type="file"]');
    const file = fileInput.files[0];
    if (!file) return alert("‚ö†Ô∏è Please upload an image!");

    const reader = new FileReader();
    reader.onload = async function () {
      const img = new Image();
      img.src = reader.result;
      img.onload = async function () {
        const tensor = tf.browser.fromPixels(img)
          .resizeNearestNeighbor([224, 224]) // 
          .toFloat()
          .expandDims();

        const prediction = await model.predict(tensor).data();
        const maxIndex = prediction.indexOf(Math.max(...prediction));

        const labels = ["Healthy", "Leaf Spot", "Blight", "Downy Mildew"]; 
        const disease = labels[maxIndex];

        document.getElementById("result").innerText = `üåø Disease Detected: ${disease}`;
      };
    };
    reader.readAsDataURL(file);
  }

  window.onload = loadModel;
</script>


  </script>


</body>
</html>
